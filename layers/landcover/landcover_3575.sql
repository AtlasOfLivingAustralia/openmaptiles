-- 3575 views, cut off at Equator

CREATE MATERIALIZED VIEW landcover_z0_3575 AS SELECT (ST_Dump(ST_MakeValid(ST_Transform(t.geometry,3575)))).geom AS geometry, t.osm_id AS osm_id, t.landuse AS landuse, t.natural AS "natural", t.leisure AS leisure, t.wetland AS wetland FROM (SELECT ST_Intersection(ST_GeomFromEWKT('SRID=4326;POLYGON((-180 0,-180 90,180 90,180 0,178 0,176 0,174 0,172 0,170 0,168 0,166 0,164 0,162 0,160 0,158 0,156 0,154 0,152 0,150 0,148 0,146 0,144 0,142 0,140 0,138 0,136 0,134 0,132 0,130 0,128 0,126 0,124 0,122 0,120 0,118 0,116 0,114 0,112 0,110 0,108 0,106 0,104 0,102 0,100 0,98 0,96 0,94 0,92 0,90 0,88 0,86 0,84 0,82 0,80 0,78 0,76 0,74 0,72 0,70 0,68 0,66 0,64 0,62 0,60 0,58 0,56 0,54 0,52 0,50 0,48 0,46 0,44 0,42 0,40 0,38 0,36 0,34 0,32 0,30 0,28 0,26 0,24 0,22 0,20 0,18 0,16 0,14 0,12 0,10 0,8 0,6 0,4 0,2 0,0 0,-2 0,-4 0,-6 0,-8 0,-10 0,-12 0,-14 0,-16 0,-18 0,-20 0,-22 0,-24 0,-26 0,-28 0,-30 0,-32 0,-34 0,-36 0,-38 0,-40 0,-42 0,-44 0,-46 0,-48 0,-50 0,-52 0,-54 0,-56 0,-58 0,-60 0,-62 0,-64 0,-66 0,-68 0,-70 0,-72 0,-74 0,-76 0,-78 0,-80 0,-82 0,-84 0,-86 0,-88 0,-90 0,-92 0,-94 0,-96 0,-98 0,-100 0,-102 0,-104 0,-106 0,-108 0,-110 0,-112 0,-114 0,-116 0,-118 0,-120 0,-122 0,-124 0,-126 0,-128 0,-130 0,-132 0,-134 0,-136 0,-138 0,-140 0,-142 0,-144 0,-146 0,-148 0,-150 0,-152 0,-154 0,-156 0,-158 0,-160 0,-162 0,-164 0,-166 0,-168 0,-170 0,-172 0,-174 0,-176 0,-178 0,-180 0))'), geometry) AS geometry, osm_id, landuse, "natural", leisure, wetland FROM landcover_z0 WHERE ST_IsValid(geometry)) AS t;
CREATE MATERIALIZED VIEW landcover_z2_3575 AS SELECT (ST_Dump(ST_MakeValid(ST_Transform(t.geometry,3575)))).geom AS geometry, t.osm_id AS osm_id, t.landuse AS landuse, t.natural AS "natural", t.leisure AS leisure, t.wetland AS wetland FROM (SELECT ST_Intersection(ST_GeomFromEWKT('SRID=4326;POLYGON((-180 0,-180 90,180 90,180 0,178 0,176 0,174 0,172 0,170 0,168 0,166 0,164 0,162 0,160 0,158 0,156 0,154 0,152 0,150 0,148 0,146 0,144 0,142 0,140 0,138 0,136 0,134 0,132 0,130 0,128 0,126 0,124 0,122 0,120 0,118 0,116 0,114 0,112 0,110 0,108 0,106 0,104 0,102 0,100 0,98 0,96 0,94 0,92 0,90 0,88 0,86 0,84 0,82 0,80 0,78 0,76 0,74 0,72 0,70 0,68 0,66 0,64 0,62 0,60 0,58 0,56 0,54 0,52 0,50 0,48 0,46 0,44 0,42 0,40 0,38 0,36 0,34 0,32 0,30 0,28 0,26 0,24 0,22 0,20 0,18 0,16 0,14 0,12 0,10 0,8 0,6 0,4 0,2 0,0 0,-2 0,-4 0,-6 0,-8 0,-10 0,-12 0,-14 0,-16 0,-18 0,-20 0,-22 0,-24 0,-26 0,-28 0,-30 0,-32 0,-34 0,-36 0,-38 0,-40 0,-42 0,-44 0,-46 0,-48 0,-50 0,-52 0,-54 0,-56 0,-58 0,-60 0,-62 0,-64 0,-66 0,-68 0,-70 0,-72 0,-74 0,-76 0,-78 0,-80 0,-82 0,-84 0,-86 0,-88 0,-90 0,-92 0,-94 0,-96 0,-98 0,-100 0,-102 0,-104 0,-106 0,-108 0,-110 0,-112 0,-114 0,-116 0,-118 0,-120 0,-122 0,-124 0,-126 0,-128 0,-130 0,-132 0,-134 0,-136 0,-138 0,-140 0,-142 0,-144 0,-146 0,-148 0,-150 0,-152 0,-154 0,-156 0,-158 0,-160 0,-162 0,-164 0,-166 0,-168 0,-170 0,-172 0,-174 0,-176 0,-178 0,-180 0))'), geometry) AS geometry, osm_id, landuse, "natural", leisure, wetland FROM landcover_z2 WHERE ST_IsValid(geometry)) AS t;
CREATE MATERIALIZED VIEW landcover_z5_3575 AS SELECT (ST_Dump(ST_MakeValid(ST_Transform(t.geometry,3575)))).geom AS geometry, t.osm_id AS osm_id, t.landuse AS landuse, t.natural AS "natural", t.leisure AS leisure, t.wetland AS wetland FROM (SELECT ST_Intersection(ST_GeomFromEWKT('SRID=4326;POLYGON((-180 0,-180 90,180 90,180 0,178 0,176 0,174 0,172 0,170 0,168 0,166 0,164 0,162 0,160 0,158 0,156 0,154 0,152 0,150 0,148 0,146 0,144 0,142 0,140 0,138 0,136 0,134 0,132 0,130 0,128 0,126 0,124 0,122 0,120 0,118 0,116 0,114 0,112 0,110 0,108 0,106 0,104 0,102 0,100 0,98 0,96 0,94 0,92 0,90 0,88 0,86 0,84 0,82 0,80 0,78 0,76 0,74 0,72 0,70 0,68 0,66 0,64 0,62 0,60 0,58 0,56 0,54 0,52 0,50 0,48 0,46 0,44 0,42 0,40 0,38 0,36 0,34 0,32 0,30 0,28 0,26 0,24 0,22 0,20 0,18 0,16 0,14 0,12 0,10 0,8 0,6 0,4 0,2 0,0 0,-2 0,-4 0,-6 0,-8 0,-10 0,-12 0,-14 0,-16 0,-18 0,-20 0,-22 0,-24 0,-26 0,-28 0,-30 0,-32 0,-34 0,-36 0,-38 0,-40 0,-42 0,-44 0,-46 0,-48 0,-50 0,-52 0,-54 0,-56 0,-58 0,-60 0,-62 0,-64 0,-66 0,-68 0,-70 0,-72 0,-74 0,-76 0,-78 0,-80 0,-82 0,-84 0,-86 0,-88 0,-90 0,-92 0,-94 0,-96 0,-98 0,-100 0,-102 0,-104 0,-106 0,-108 0,-110 0,-112 0,-114 0,-116 0,-118 0,-120 0,-122 0,-124 0,-126 0,-128 0,-130 0,-132 0,-134 0,-136 0,-138 0,-140 0,-142 0,-144 0,-146 0,-148 0,-150 0,-152 0,-154 0,-156 0,-158 0,-160 0,-162 0,-164 0,-166 0,-168 0,-170 0,-172 0,-174 0,-176 0,-178 0,-180 0))'), geometry) AS geometry, osm_id, landuse, "natural", leisure, wetland FROM landcover_z5 WHERE ST_IsValid(geometry)) AS t;
CREATE MATERIALIZED VIEW landcover_z8_3575 AS SELECT (ST_Dump(ST_MakeValid(ST_Transform(t.geometry,3575)))).geom AS geometry, t.osm_id AS osm_id, t.landuse AS landuse, t.natural AS "natural", t.leisure AS leisure, t.wetland AS wetland FROM (SELECT ST_Intersection(ST_GeomFromEWKT('SRID=4326;POLYGON((-180 0,-180 90,180 90,180 0,178 0,176 0,174 0,172 0,170 0,168 0,166 0,164 0,162 0,160 0,158 0,156 0,154 0,152 0,150 0,148 0,146 0,144 0,142 0,140 0,138 0,136 0,134 0,132 0,130 0,128 0,126 0,124 0,122 0,120 0,118 0,116 0,114 0,112 0,110 0,108 0,106 0,104 0,102 0,100 0,98 0,96 0,94 0,92 0,90 0,88 0,86 0,84 0,82 0,80 0,78 0,76 0,74 0,72 0,70 0,68 0,66 0,64 0,62 0,60 0,58 0,56 0,54 0,52 0,50 0,48 0,46 0,44 0,42 0,40 0,38 0,36 0,34 0,32 0,30 0,28 0,26 0,24 0,22 0,20 0,18 0,16 0,14 0,12 0,10 0,8 0,6 0,4 0,2 0,0 0,-2 0,-4 0,-6 0,-8 0,-10 0,-12 0,-14 0,-16 0,-18 0,-20 0,-22 0,-24 0,-26 0,-28 0,-30 0,-32 0,-34 0,-36 0,-38 0,-40 0,-42 0,-44 0,-46 0,-48 0,-50 0,-52 0,-54 0,-56 0,-58 0,-60 0,-62 0,-64 0,-66 0,-68 0,-70 0,-72 0,-74 0,-76 0,-78 0,-80 0,-82 0,-84 0,-86 0,-88 0,-90 0,-92 0,-94 0,-96 0,-98 0,-100 0,-102 0,-104 0,-106 0,-108 0,-110 0,-112 0,-114 0,-116 0,-118 0,-120 0,-122 0,-124 0,-126 0,-128 0,-130 0,-132 0,-134 0,-136 0,-138 0,-140 0,-142 0,-144 0,-146 0,-148 0,-150 0,-152 0,-154 0,-156 0,-158 0,-160 0,-162 0,-164 0,-166 0,-168 0,-170 0,-172 0,-174 0,-176 0,-178 0,-180 0))'), geometry) AS geometry, osm_id, landuse, "natural", leisure, wetland FROM landcover_z8 WHERE ST_IsValid(geometry)) AS t;
CREATE MATERIALIZED VIEW landcover_z9_3575 AS SELECT (ST_Dump(ST_MakeValid(ST_Transform(t.geometry,3575)))).geom AS geometry, t.osm_id AS osm_id, t.landuse AS landuse, t.natural AS "natural", t.leisure AS leisure, t.wetland AS wetland FROM (SELECT ST_Intersection(ST_GeomFromEWKT('SRID=4326;POLYGON((-180 0,-180 90,180 90,180 0,178 0,176 0,174 0,172 0,170 0,168 0,166 0,164 0,162 0,160 0,158 0,156 0,154 0,152 0,150 0,148 0,146 0,144 0,142 0,140 0,138 0,136 0,134 0,132 0,130 0,128 0,126 0,124 0,122 0,120 0,118 0,116 0,114 0,112 0,110 0,108 0,106 0,104 0,102 0,100 0,98 0,96 0,94 0,92 0,90 0,88 0,86 0,84 0,82 0,80 0,78 0,76 0,74 0,72 0,70 0,68 0,66 0,64 0,62 0,60 0,58 0,56 0,54 0,52 0,50 0,48 0,46 0,44 0,42 0,40 0,38 0,36 0,34 0,32 0,30 0,28 0,26 0,24 0,22 0,20 0,18 0,16 0,14 0,12 0,10 0,8 0,6 0,4 0,2 0,0 0,-2 0,-4 0,-6 0,-8 0,-10 0,-12 0,-14 0,-16 0,-18 0,-20 0,-22 0,-24 0,-26 0,-28 0,-30 0,-32 0,-34 0,-36 0,-38 0,-40 0,-42 0,-44 0,-46 0,-48 0,-50 0,-52 0,-54 0,-56 0,-58 0,-60 0,-62 0,-64 0,-66 0,-68 0,-70 0,-72 0,-74 0,-76 0,-78 0,-80 0,-82 0,-84 0,-86 0,-88 0,-90 0,-92 0,-94 0,-96 0,-98 0,-100 0,-102 0,-104 0,-106 0,-108 0,-110 0,-112 0,-114 0,-116 0,-118 0,-120 0,-122 0,-124 0,-126 0,-128 0,-130 0,-132 0,-134 0,-136 0,-138 0,-140 0,-142 0,-144 0,-146 0,-148 0,-150 0,-152 0,-154 0,-156 0,-158 0,-160 0,-162 0,-164 0,-166 0,-168 0,-170 0,-172 0,-174 0,-176 0,-178 0,-180 0))'), geometry) AS geometry, osm_id, landuse, "natural", leisure, wetland FROM landcover_z9 WHERE ST_IsValid(geometry)) AS t;
CREATE MATERIALIZED VIEW landcover_z10_3575 AS SELECT (ST_Dump(ST_MakeValid(ST_Transform(t.geometry,3575)))).geom AS geometry, t.osm_id AS osm_id, t.landuse AS landuse, t.natural AS "natural", t.leisure AS leisure, t.wetland AS wetland FROM (SELECT ST_Intersection(ST_GeomFromEWKT('SRID=4326;POLYGON((-180 0,-180 90,180 90,180 0,178 0,176 0,174 0,172 0,170 0,168 0,166 0,164 0,162 0,160 0,158 0,156 0,154 0,152 0,150 0,148 0,146 0,144 0,142 0,140 0,138 0,136 0,134 0,132 0,130 0,128 0,126 0,124 0,122 0,120 0,118 0,116 0,114 0,112 0,110 0,108 0,106 0,104 0,102 0,100 0,98 0,96 0,94 0,92 0,90 0,88 0,86 0,84 0,82 0,80 0,78 0,76 0,74 0,72 0,70 0,68 0,66 0,64 0,62 0,60 0,58 0,56 0,54 0,52 0,50 0,48 0,46 0,44 0,42 0,40 0,38 0,36 0,34 0,32 0,30 0,28 0,26 0,24 0,22 0,20 0,18 0,16 0,14 0,12 0,10 0,8 0,6 0,4 0,2 0,0 0,-2 0,-4 0,-6 0,-8 0,-10 0,-12 0,-14 0,-16 0,-18 0,-20 0,-22 0,-24 0,-26 0,-28 0,-30 0,-32 0,-34 0,-36 0,-38 0,-40 0,-42 0,-44 0,-46 0,-48 0,-50 0,-52 0,-54 0,-56 0,-58 0,-60 0,-62 0,-64 0,-66 0,-68 0,-70 0,-72 0,-74 0,-76 0,-78 0,-80 0,-82 0,-84 0,-86 0,-88 0,-90 0,-92 0,-94 0,-96 0,-98 0,-100 0,-102 0,-104 0,-106 0,-108 0,-110 0,-112 0,-114 0,-116 0,-118 0,-120 0,-122 0,-124 0,-126 0,-128 0,-130 0,-132 0,-134 0,-136 0,-138 0,-140 0,-142 0,-144 0,-146 0,-148 0,-150 0,-152 0,-154 0,-156 0,-158 0,-160 0,-162 0,-164 0,-166 0,-168 0,-170 0,-172 0,-174 0,-176 0,-178 0,-180 0))'), geometry) AS geometry, osm_id, landuse, "natural", leisure, wetland FROM landcover_z10 WHERE ST_IsValid(geometry)) AS t;
CREATE MATERIALIZED VIEW landcover_z11_3575 AS SELECT (ST_Dump(ST_MakeValid(ST_Transform(t.geometry,3575)))).geom AS geometry, t.osm_id AS osm_id, t.landuse AS landuse, t.natural AS "natural", t.leisure AS leisure, t.wetland AS wetland FROM (SELECT ST_Intersection(ST_GeomFromEWKT('SRID=4326;POLYGON((-180 0,-180 90,180 90,180 0,178 0,176 0,174 0,172 0,170 0,168 0,166 0,164 0,162 0,160 0,158 0,156 0,154 0,152 0,150 0,148 0,146 0,144 0,142 0,140 0,138 0,136 0,134 0,132 0,130 0,128 0,126 0,124 0,122 0,120 0,118 0,116 0,114 0,112 0,110 0,108 0,106 0,104 0,102 0,100 0,98 0,96 0,94 0,92 0,90 0,88 0,86 0,84 0,82 0,80 0,78 0,76 0,74 0,72 0,70 0,68 0,66 0,64 0,62 0,60 0,58 0,56 0,54 0,52 0,50 0,48 0,46 0,44 0,42 0,40 0,38 0,36 0,34 0,32 0,30 0,28 0,26 0,24 0,22 0,20 0,18 0,16 0,14 0,12 0,10 0,8 0,6 0,4 0,2 0,0 0,-2 0,-4 0,-6 0,-8 0,-10 0,-12 0,-14 0,-16 0,-18 0,-20 0,-22 0,-24 0,-26 0,-28 0,-30 0,-32 0,-34 0,-36 0,-38 0,-40 0,-42 0,-44 0,-46 0,-48 0,-50 0,-52 0,-54 0,-56 0,-58 0,-60 0,-62 0,-64 0,-66 0,-68 0,-70 0,-72 0,-74 0,-76 0,-78 0,-80 0,-82 0,-84 0,-86 0,-88 0,-90 0,-92 0,-94 0,-96 0,-98 0,-100 0,-102 0,-104 0,-106 0,-108 0,-110 0,-112 0,-114 0,-116 0,-118 0,-120 0,-122 0,-124 0,-126 0,-128 0,-130 0,-132 0,-134 0,-136 0,-138 0,-140 0,-142 0,-144 0,-146 0,-148 0,-150 0,-152 0,-154 0,-156 0,-158 0,-160 0,-162 0,-164 0,-166 0,-168 0,-170 0,-172 0,-174 0,-176 0,-178 0,-180 0))'), geometry) AS geometry, osm_id, landuse, "natural", leisure, wetland FROM landcover_z11 WHERE ST_IsValid(geometry)) AS t;
CREATE MATERIALIZED VIEW landcover_z12_3575 AS SELECT (ST_Dump(ST_MakeValid(ST_Transform(t.geometry,3575)))).geom AS geometry, t.osm_id AS osm_id, t.landuse AS landuse, t.natural AS "natural", t.leisure AS leisure, t.wetland AS wetland FROM (SELECT ST_Intersection(ST_GeomFromEWKT('SRID=4326;POLYGON((-180 0,-180 90,180 90,180 0,178 0,176 0,174 0,172 0,170 0,168 0,166 0,164 0,162 0,160 0,158 0,156 0,154 0,152 0,150 0,148 0,146 0,144 0,142 0,140 0,138 0,136 0,134 0,132 0,130 0,128 0,126 0,124 0,122 0,120 0,118 0,116 0,114 0,112 0,110 0,108 0,106 0,104 0,102 0,100 0,98 0,96 0,94 0,92 0,90 0,88 0,86 0,84 0,82 0,80 0,78 0,76 0,74 0,72 0,70 0,68 0,66 0,64 0,62 0,60 0,58 0,56 0,54 0,52 0,50 0,48 0,46 0,44 0,42 0,40 0,38 0,36 0,34 0,32 0,30 0,28 0,26 0,24 0,22 0,20 0,18 0,16 0,14 0,12 0,10 0,8 0,6 0,4 0,2 0,0 0,-2 0,-4 0,-6 0,-8 0,-10 0,-12 0,-14 0,-16 0,-18 0,-20 0,-22 0,-24 0,-26 0,-28 0,-30 0,-32 0,-34 0,-36 0,-38 0,-40 0,-42 0,-44 0,-46 0,-48 0,-50 0,-52 0,-54 0,-56 0,-58 0,-60 0,-62 0,-64 0,-66 0,-68 0,-70 0,-72 0,-74 0,-76 0,-78 0,-80 0,-82 0,-84 0,-86 0,-88 0,-90 0,-92 0,-94 0,-96 0,-98 0,-100 0,-102 0,-104 0,-106 0,-108 0,-110 0,-112 0,-114 0,-116 0,-118 0,-120 0,-122 0,-124 0,-126 0,-128 0,-130 0,-132 0,-134 0,-136 0,-138 0,-140 0,-142 0,-144 0,-146 0,-148 0,-150 0,-152 0,-154 0,-156 0,-158 0,-160 0,-162 0,-164 0,-166 0,-168 0,-170 0,-172 0,-174 0,-176 0,-178 0,-180 0))'), geometry) AS geometry, osm_id, landuse, "natural", leisure, wetland FROM landcover_z12 WHERE ST_IsValid(geometry)) AS t;
CREATE MATERIALIZED VIEW landcover_z13_3575 AS SELECT (ST_Dump(ST_MakeValid(ST_Transform(t.geometry,3575)))).geom AS geometry, t.osm_id AS osm_id, t.landuse AS landuse, t.natural AS "natural", t.leisure AS leisure, t.wetland AS wetland FROM (SELECT ST_Intersection(ST_GeomFromEWKT('SRID=4326;POLYGON((-180 0,-180 90,180 90,180 0,178 0,176 0,174 0,172 0,170 0,168 0,166 0,164 0,162 0,160 0,158 0,156 0,154 0,152 0,150 0,148 0,146 0,144 0,142 0,140 0,138 0,136 0,134 0,132 0,130 0,128 0,126 0,124 0,122 0,120 0,118 0,116 0,114 0,112 0,110 0,108 0,106 0,104 0,102 0,100 0,98 0,96 0,94 0,92 0,90 0,88 0,86 0,84 0,82 0,80 0,78 0,76 0,74 0,72 0,70 0,68 0,66 0,64 0,62 0,60 0,58 0,56 0,54 0,52 0,50 0,48 0,46 0,44 0,42 0,40 0,38 0,36 0,34 0,32 0,30 0,28 0,26 0,24 0,22 0,20 0,18 0,16 0,14 0,12 0,10 0,8 0,6 0,4 0,2 0,0 0,-2 0,-4 0,-6 0,-8 0,-10 0,-12 0,-14 0,-16 0,-18 0,-20 0,-22 0,-24 0,-26 0,-28 0,-30 0,-32 0,-34 0,-36 0,-38 0,-40 0,-42 0,-44 0,-46 0,-48 0,-50 0,-52 0,-54 0,-56 0,-58 0,-60 0,-62 0,-64 0,-66 0,-68 0,-70 0,-72 0,-74 0,-76 0,-78 0,-80 0,-82 0,-84 0,-86 0,-88 0,-90 0,-92 0,-94 0,-96 0,-98 0,-100 0,-102 0,-104 0,-106 0,-108 0,-110 0,-112 0,-114 0,-116 0,-118 0,-120 0,-122 0,-124 0,-126 0,-128 0,-130 0,-132 0,-134 0,-136 0,-138 0,-140 0,-142 0,-144 0,-146 0,-148 0,-150 0,-152 0,-154 0,-156 0,-158 0,-160 0,-162 0,-164 0,-166 0,-168 0,-170 0,-172 0,-174 0,-176 0,-178 0,-180 0))'), geometry) AS geometry, osm_id, landuse, "natural", leisure, wetland FROM landcover_z13 WHERE ST_IsValid(geometry)) AS t;
CREATE MATERIALIZED VIEW landcover_z14_3575 AS SELECT (ST_Dump(ST_MakeValid(ST_Transform(t.geometry,3575)))).geom AS geometry, t.osm_id AS osm_id, t.landuse AS landuse, t.natural AS "natural", t.leisure AS leisure, t.wetland AS wetland FROM (SELECT ST_Intersection(ST_GeomFromEWKT('SRID=4326;POLYGON((-180 0,-180 90,180 90,180 0,178 0,176 0,174 0,172 0,170 0,168 0,166 0,164 0,162 0,160 0,158 0,156 0,154 0,152 0,150 0,148 0,146 0,144 0,142 0,140 0,138 0,136 0,134 0,132 0,130 0,128 0,126 0,124 0,122 0,120 0,118 0,116 0,114 0,112 0,110 0,108 0,106 0,104 0,102 0,100 0,98 0,96 0,94 0,92 0,90 0,88 0,86 0,84 0,82 0,80 0,78 0,76 0,74 0,72 0,70 0,68 0,66 0,64 0,62 0,60 0,58 0,56 0,54 0,52 0,50 0,48 0,46 0,44 0,42 0,40 0,38 0,36 0,34 0,32 0,30 0,28 0,26 0,24 0,22 0,20 0,18 0,16 0,14 0,12 0,10 0,8 0,6 0,4 0,2 0,0 0,-2 0,-4 0,-6 0,-8 0,-10 0,-12 0,-14 0,-16 0,-18 0,-20 0,-22 0,-24 0,-26 0,-28 0,-30 0,-32 0,-34 0,-36 0,-38 0,-40 0,-42 0,-44 0,-46 0,-48 0,-50 0,-52 0,-54 0,-56 0,-58 0,-60 0,-62 0,-64 0,-66 0,-68 0,-70 0,-72 0,-74 0,-76 0,-78 0,-80 0,-82 0,-84 0,-86 0,-88 0,-90 0,-92 0,-94 0,-96 0,-98 0,-100 0,-102 0,-104 0,-106 0,-108 0,-110 0,-112 0,-114 0,-116 0,-118 0,-120 0,-122 0,-124 0,-126 0,-128 0,-130 0,-132 0,-134 0,-136 0,-138 0,-140 0,-142 0,-144 0,-146 0,-148 0,-150 0,-152 0,-154 0,-156 0,-158 0,-160 0,-162 0,-164 0,-166 0,-168 0,-170 0,-172 0,-174 0,-176 0,-178 0,-180 0))'), geometry) AS geometry, osm_id, landuse, "natural", leisure, wetland FROM landcover_z14 WHERE ST_IsValid(geometry)) AS t;

CREATE INDEX landcover_z0_3575_idx ON landcover_z0_3575 USING gist (geometry);
CREATE INDEX landcover_z2_3575_idx ON landcover_z2_3575 USING gist (geometry);
CREATE INDEX landcover_z5_3575_idx ON landcover_z5_3575 USING gist (geometry);
CREATE INDEX landcover_z8_3575_idx ON landcover_z8_3575 USING gist (geometry);
CREATE INDEX landcover_z9_3575_idx ON landcover_z9_3575 USING gist (geometry);
CREATE INDEX landcover_z10_3575_idx ON landcover_z10_3575 USING gist (geometry);
CREATE INDEX landcover_z11_3575_idx ON landcover_z11_3575 USING gist (geometry);
CREATE INDEX landcover_z12_3575_idx ON landcover_z12_3575 USING gist (geometry);
CREATE INDEX landcover_z13_3575_idx ON landcover_z13_3575 USING gist (geometry);
CREATE INDEX landcover_z14_3575_idx ON landcover_z14_3575 USING gist (geometry);

CREATE OR REPLACE FUNCTION layer_landcover_3575(bbox geometry, zoom_level int)
RETURNS TABLE(osm_id bigint, geometry geometry, class text, subclass text) AS $$
    SELECT osm_id, geometry,
        landcover_class(landuse, "natural", leisure, wetland) AS class,
        COALESCE(
            NULLIF("natural", ''), NULLIF(landuse, ''),
            NULLIF(leisure, ''), NULLIF(wetland, '')
        ) AS subclass
        FROM (
        -- etldoc:  landcover_z0 -> layer_landcover:z0_1
        SELECT * FROM landcover_z0_3575
        WHERE zoom_level BETWEEN 0 AND 1 AND geometry && bbox
        UNION ALL
        -- etldoc:  landcover_z2 -> layer_landcover:z2_4
        SELECT * FROM landcover_z2_3575
        WHERE zoom_level BETWEEN 2 AND 4 AND geometry && bbox
        UNION ALL
        -- etldoc:  landcover_z5 -> layer_landcover:z5_7
        SELECT * FROM landcover_z5_3575
        WHERE zoom_level BETWEEN 5 AND 7 AND geometry && bbox
        UNION ALL
        -- etldoc:  landcover_z8 -> layer_landcover:z8
        SELECT *
        FROM landcover_z8_3575 WHERE zoom_level = 8 AND geometry && bbox
        UNION ALL
        -- etldoc:  landcover_z9 -> layer_landcover:z9
        SELECT *
        FROM landcover_z9_3575 WHERE zoom_level = 9 AND geometry && bbox
        UNION ALL
        -- etldoc:  landcover_z10 -> layer_landcover:z10
        SELECT *
        FROM landcover_z10_3575 WHERE zoom_level = 10 AND geometry && bbox
        UNION ALL
        -- etldoc:  landcover_z11 -> layer_landcover:z11
        SELECT *
        FROM landcover_z11_3575 WHERE zoom_level = 11 AND geometry && bbox
        UNION ALL
        -- etldoc:  landcover_z12 -> layer_landcover:z12
        SELECT *
        FROM landcover_z12_3575 WHERE zoom_level = 12 AND geometry && bbox
        UNION ALL
        -- etldoc:  landcover_z13 -> layer_landcover:z13
        SELECT *
        FROM landcover_z13_3575 WHERE zoom_level = 13 AND geometry && bbox
        UNION ALL
        -- etldoc:  landcover_z14 -> layer_landcover:z14_
        SELECT *
        FROM landcover_z14_3575 WHERE zoom_level >= 14 AND geometry && bbox
    ) AS zoom_levels;
$$ LANGUAGE SQL IMMUTABLE;
